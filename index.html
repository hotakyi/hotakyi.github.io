<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>hota&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="hota&#39;s blog">
<meta property="og:url" content="https://blog.hotagames.com/index.html">
<meta property="og:site_name" content="hota&#39;s blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hota&#39;s blog">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/webfonts/ptserif/main.css">
  <link rel="stylesheet" href="/webfonts/ptserif/source-code-pro.css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo logo-text" href="/">hota&#39;s</a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
          <a class="main-nav-link" href="/atom.xml">Rss</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://blog.hotagames.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer">
      <article id="post-payment-security" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/08/payment-security/">支付安全</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2018/04/08/payment-security/" class="article-date">
  <time datetime="2018-04-07T16:00:00.000Z" itemprop="datePublished">2018-04-08</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    
    
  </div>
  
</article>








    
      <article id="post-page-hijacking" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/07/page-hijacking/">網頁劫持</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2018/04/07/page-hijacking/" class="article-date">
  <time datetime="2018-04-06T16:00:00.000Z" itemprop="datePublished">2018-04-07</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    
    
  </div>
  
</article>








    
      <article id="post-encrypted-chat" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/06/encrypted-chat/">聊天加密</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2018/04/06/encrypted-chat/" class="article-date">
  <time datetime="2018-04-06T12:58:20.000Z" itemprop="datePublished">2018-04-06</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/images/encrypted-chat.jpg" alt=""></p>
<p>現在流行的聊天 app 基本都會使用 <strong>端到端加密</strong> (end-to-end encryption, E2EE)，使聊天更為安全。如 <a href="https://www.whatsapp.com/" target="_blank" rel="noopener">Whatsapp</a>, <a href="https://telegram.org/" target="_blank" rel="noopener">Telegram</a>, <a href="https://en.wikipedia.org/wiki/IMessage" target="_blank" rel="noopener">iMessage</a>。</p>
<p>由於聊天軟件都會有服務器，如果只是使用 HTTPS，訊息在服務端解密，所以控制到服務端的人，還是能看到你的聊天內容，所以只用 HTTPS 連線到服務器也未能滿足對聊天私密性的需求。</p>
<p>基本原理是 A 客戶端先把聊天內容加密發到服務器，服務器可能先保存或直接把加密過的內容發給 B 客戶端，然後 B 客戶端解密並顯示內容；由於服務端沒法解密，所以服務端保不保存聊天內容根本不用擔心。詳細原理可以看<a href="https://zh.wikipedia.org/wiki/端到端加密" target="_blank" rel="noopener">這裡</a>。</p>

      
    </div>
    
    
  </div>
  
</article>








    
      <article id="post-basic-security" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/05/basic-security/">網絡安全誤會</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2018/04/05/basic-security/" class="article-date">
  <time datetime="2018-04-04T16:00:00.000Z" itemprop="datePublished">2018-04-05</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/images/internet-security-1.jpg" alt=""></p>
<p>最近好像有遇到不少朋友誤會了一些所謂網絡安全的問題，所以想在這裡簡單地說一下。</p>
<h2 id="連線加密"><a href="#連線加密" class="headerlink" title="連線加密"></a>連線加密</h2><p>連線加密是用來防止連線過程中，數據被讀取、修改，主要是防止中間人。服務端把要發給客戶端數據的時候，先把數據加密再發出，到了客戶端的之後由客戶端解密再進行處理。有些人以為數據加密後，就只有客戶端軟件能解密，以為這就安全了。其實網絡軟件一個最基本原則，發出去東西，要假定客戶端收到一定能修改，客戶端發過來的東西也需要假定被修改過，一定要驗證。數據到了別人的電腦，你的軟件能解密，你用任何方法去防止別人拿出來也是徒勞的；在別人的電腦連 RAM 裡的數據都能讀取修改，就算你花盡心思，最後只不過是稍為讓別人多花了一點時間。<strong>重覆～ 除非客戶端不解密，否則加密只能防中間人。</strong></p>
<h3 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h3><p>既然連線加密只是為了防止中間人，不是為了防客戶端的話，那 HTTPS 就足夠了，而且基本上跟你開發的軟件方開，不會增加開發時間和繁雜程度。HTTPS 是一個最多人維護的標準，既然已經有人做好的東西，不要試圖去開發”自主開發”一套加密方法。只要你先假設發數據過來的可以是任何人、可以發任意的數據，而服務端有去譣證好是對的人、對的操作，那麼通信是用明文經 HTTPS 傳送也是安全的。<a href="https://robertheaton.com/2014/03/27/how-does-https-actually-work/" target="_blank" rel="noopener">自己去看原理</a>。</p>
<h4 id="其他可能要注意的地方"><a href="#其他可能要注意的地方" class="headerlink" title="其他可能要注意的地方"></a>其他可能要注意的地方</h4><ul>
<li>瀏覽器本身進行解密，所以一定能看到解密後的數據，所以要使用可靠的瀏覽器，如 <a href="https://www.google.com/chrome" target="_blank" rel="noopener">chrome</a>, <a href="https://firefox.com" target="_blank" rel="noopener">firefox</a>, <a href="https://www.apple.com/safari" target="_blank" rel="noopener">safari</a>。</li>
<li>由於 HTTPS 的安全在於對根證書的信任，所以不要胡亂在系統裡信任不明的證書，也不要使用可能或經常會信任不被廣泛信任的根證書的瀏覽器，例如中國出品的瀏覽器。</li>
<li>如果服務端或客戶端的機器中毒，還是會受中間人攻擊，HTTPS 安全只是在未解密的傳輸的時候。</li>
</ul>
<h2 id="服務器數據安全"><a href="#服務器數據安全" class="headerlink" title="服務器數據安全"></a>服務器數據安全</h2><p>這裡要說的不是數據庫的問題，而是客戶端傳過來的數據。上面已經提到，客戶端的傳過來的數據要假設他可以被人任意修改，所以收到的每一個請求都必需檢查數據的真確性。這就是那麼多之前的 facebook 遊戲、手機遊戲、<a href="https://www.ea.com" target="_blank" rel="noopener">EA</a> 的遊戲被破解的原因，因為它們很多時候都不會對數據進行驗證。</p>
<p>你可能會懷疑這些大公司的軟件為什麼要這樣做，這是因為他們刻意如此。遊戲類的軟件，如果是在服務器計算，意思是服務器撿查每一個操作，例如每一幀畫面子彈的位置，就需要很多計算能力。除此之外還需要大量的網絡傳輸，網絡成本提高，而且客戶沒有良好網絡的時候，體驗會大打折扣，所以智能手機興起初期並沒有太多實時遊戲。所以他們的團隊因為用戶體驗、開發成本、營運成本而選擇了遊戲結果在客戶端計算的設計，客戶端發遊戲幣總額什麼的過來都存入數據庫，反正會破解遊戲的人基本上也不會付錢。</p>
<p>但是如果是用戶餘額、賬單總額這一類重要的數據就必需要驗證了。</p>
<p>順帶一提，<a href="http://supercell.com/en/games/clashofclans/" target="_blank" rel="noopener">Clash of Clans</a> 的設計優美之處，以下是我對這個遊戲的觀察和猜測。這遊戲運作很 deterministic，每一局開始服務器會傳送敵陣的資料到客戶端，然後遊戲首先是在客戶端計算，最後把遊戲過程發送到服務端，所以遊戲中途就算手機斷線也不會有影響，只會在回合結束的時候可能會要等數據傳回服務器的情況。數據的內容不只是遊戲的結果，主要是每一個操作的時間，例如你選了哪一個兵種，點了哪一個位置。服務器收到後會重新計算一次，因為每一種兵都有一個 deterministic 的 AI，所以計算的時候同一個位置，同一個時間點，那一隻兵會做什麼都是相同的。當然這樣做還是不完美的，你可能可以在收到敵陣的數據之後，高速運算出最佳玩法，然後把最佳玩法返回給服務器(據觀察服務器有返回結果的時間限制)，但是為了玩個遊戲這樣做代價太大了。</p>

      
    </div>
    
    
  </div>
  
</article>








    </section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Joe Leung&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>