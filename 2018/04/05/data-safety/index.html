<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="hota's blog" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>服務端安全 - hota's blog</title><link rel="stylesheet" href="/css/main.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="head"><h1 class="head-title u-fl"><a href="/">hota's blog</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/" class="head-nav__link">Home</a></li><li class="head-nav__item"><a href="/archives" class="head-nav__link">Archives</a></li><li class="head-nav__item"><a href="/about" class="head-nav__link">About</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2018-04-05T12:58:20.000Z" class="post__time">April 5, 2018</time><h1 class="post__title"><a href="/2018/04/05/data-safety/">服務端安全</a></h1></header><div class="post__main echo"><p><img src="/images/sensor-tower-q2.jpg" alt="Image Credit: Sensor Tower"></p>
<h2 id="服務器數據安全"><a href="#服務器數據安全" class="headerlink" title="服務器數據安全"></a>服務器數據安全</h2><p>這裡要說的不是數據庫的問題，而是客戶端傳過來的數據。上面已經提到，客戶端的傳過來的數據要假設他可以被人任意修改，所以收到的每一個請求都必需檢查數據的真確性。這就是那麼多之前的 facebook 遊戲、手機遊戲、<a href="https://www.ea.com" target="_blank" rel="noopener">EA</a> 的遊戲被破解的原因，因為它們很多時候都不會對數據進行驗證。</p>
<p>你可能會懷疑這些大公司的軟件為什麼要這樣做，這是因為他們刻意如此。遊戲類的軟件，如果是在服務器計算，意思是服務器撿查每一個操作，例如每一幀畫面子彈的位置，就需要很多計算能力。除此之外還需要大量的網絡傳輸，網絡成本提高，而且客戶沒有良好網絡的時候，體驗會大打折扣，所以智能手機興起初期並沒有太多實時遊戲。所以他們的團隊因為用戶體驗、開發成本、營運成本而選擇了遊戲結果在客戶端計算的設計，客戶端發遊戲幣總額什麼的過來都存入數據庫，反正會破解遊戲的人基本上也不會付錢。</p>
<p>但是如果是用戶餘額、賬單總額這一類重要的數據就必需要驗證了。</p>
<p>順帶一提，<a href="http://supercell.com/en/games/clashofclans" target="_blank" rel="noopener">Clash of Clans</a> 的設計優美之處，以下是我對這個遊戲的觀察和猜測。這遊戲運作很 deterministic，每一局開始服務器會傳送敵陣的資料到客戶端，然後遊戲首先是在客戶端計算，最後把遊戲過程發送到服務端，所以遊戲中途就算手機斷線也不會有影響，只會在回合結束的時候可能會要等數據傳回服務器的情況。數據的內容不只是遊戲的結果，主要是每一個操作的時間，例如你選了哪一個兵種，點了哪一個位置。服務器收到後會重新計算一次，因為每一種兵都有一個 deterministic 的 AI，所以計算的時候同一個位置，同一個時間點，那一隻兵會做什麼都是相同的。當然這樣做還是不完美的，你可能可以在收到敵陣的數據之後，高速運算出最佳玩法，然後把最佳玩法返回給服務器(據觀察服務器有返回結果的時間限制)，但是為了玩個遊戲這樣做代價太大了。</p>
</div><footer class="post__foot u-cf"><a href="/2018/04/05/data-safety/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2018 Joe Leung</div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/2018/04/06/encrypted-chat/" class="page-menu__link icon-arrow-left"></a></li><li class="page-menu__item"><a title="Next" href="/2018/04/05/basic-security/" class="page-menu__link icon-arrow-right"></a></li></menu></footer></body></html>